#Drug Recommendation System for CVD


##Overview

This project contains libraries to train Ann Models for predicting Drug recommendations for people with cardiac diseases
based on their admission history by training on the Mimic-4 dataset.


##Setup

### Dataset

The Mimic-4 dataset (https://physionet.org/content/mimiciv/1.0/#files-panel) is used for generating input features for training the model.
Download the dataset and save the uncompressed folder under '/data'.

### Feature Generation

The required features for model training are generated by running the following script from base path (directory containing '/data').

    python3 preprocessing/save_features.py

The above scripts saves the generated features including combined-code dictionary, Pmi Matrix, and patient dictionaries under '/data/features'


## Model Execution

The model design is based on Gate implementation. (https://www.researchgate.net/publication/342762237_GATE_Graph-Attention_Augmented_Temporal_Neural_Network_for_Medication_Recommendation)
Model design follows same notation as the equations in the paper referred above.

We use a 80/20 split for training and validating the model performance.

To train the model, run the following script-

    python3 model/training.py

Trained model weights and losses are saved under 'outputs/<date-time>' directory.  
For visualizing the performance metrics of the model for training and validation data, run-

    python3 utils/plot_loss.py

For running inference-

    python3 model/inference.py

Above script prints out the recommended drug NDC codes corresponding to a patient history.

## TODO

1. Hyperparameter Tuning to improve the performance
2. Remove some non cardiac codes in admissions?